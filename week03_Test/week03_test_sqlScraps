SELECT first_name, last_name, manager_id 
FROM employees
WHERE department_id IN
(SELECT department_id FROM departments WHERE location_id IN (
SELECT location_id FROM locations WHERE country_id='US'));

/* final answer to 3 */ 
SELECT first_name, last_name, manager_id
FROM employees
WHERE manager_id IN 
(SELECT employee_id FROM employees WHERE department_id IN
(SELECT department_id FROM departments WHERE location_id IN 
(SELECT location_id FROM locations WHERE country_id='US')));

SELECT * FROM departments;

SELECT * FROM locations;

SELECT * FROM employees;

SELECT department_id FROM departments;

SELECT department_id FROM departments WHERE location_id IN
(SELECT location_id FROM locations WHERE country_id='US');

/* only getting employees from US */
SELECT employee_id FROM employees WHERE department_id IN
(SELECT department_id FROM departments WHERE location_id IN 
(SELECT location_id FROM locations WHERE country_id='US'));



SELECT first_name, last_name, manager_id
FROM employees
GROUP BY department_id 
HAVING (SELECT department_id FROM departments) WHERE
(SELECT location_id FROM locations WHERE country_id='US');

SELECT first_name, last_name, manager_id
FROM employees
JOIN departments ON employees.department_id = departments.department_id
WHERE location_id IN
(SELECT location_id FROM locations WHERE country_id='US');

SELECT first_name, last_name, manager_id
FROM employees
JOIN departments ON employees.department_id = departments.department_id
WHERE (location_id = 1400) OR (location_id = 1500) OR location_id = (1700);


SELECT first_name, last_name, manager_id FROM employees
WHERE manager_id IN
(SELECT employee_id FROM employees);

SELECT department_id FROM departments WHERE location_id IN (
SELECT location_id FROM locations WHERE country_id='US');

/* answer to 4 */ 
SELECT job_id, (MAX(salary)- MIN(salary)) AS salary_span
FROM employees
WHERE job_id IS NOT 9
GROUP BY job_id
ORDER BY salary_span DESC; 